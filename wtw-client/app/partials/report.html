<div ng-controller="ReportCtrl">
  
  <label>Show temperatures:</label>
  <input type="checkbox" ng-model="showTemps">
  <br>
  
  <label>Show forecast times:</label>
  <span ng-repeat="freq in forecastFreqs" ng-if="freq >= availableForecastFreq">
    <input type="radio" ng-model="$parent.$parent.forecastFreq" value="{{freq}}">Every {{freq}} hr
  </span>
  <br>
  
  <label>Show ahead times:</label>
  <span ng-repeat="freq in aheadFreqs">
    <input type="radio" ng-model="$parent.aheadFreq" value="{{freq}}">Every {{freq}} hr
  </span>
  <br>
  <br>
  
  <table>
    <!-- Day row -->
    <tr>
      <th rowspan="2"></th>
      <th ng-repeat="forecastDay in forecastDays" colspan="{{forecastDay.forecastCount}}">
        {{forecastDay.name}}
      </td>
    </tr>
    <!-- Time row -->
    <tr>
      <th ng-repeat="forecastTime in forecastTimes" ng-if="!($index % (forecastFreq / availableForecastFreq))">
        {{forecastTime | date: 'ha'}}
      </th>
    </tr>
    <!-- Forecast rows -->
    <tr ng-repeat="(aheadIndex, aheadTime) in aheadTimes" ng-if="!($index % aheadFreq)">
      <th>        
        <span ng-if="$first">Actual</span>
        <span ng-if="!$first">-{{aheadTime}}hr</span>
      </th>
      <td ng-repeat="(forecastIndex, forecastTime) in forecasts" ng-if="!($index % (forecastFreq / availableForecastFreq))" ng-init="fc = forecasts[forecastIndex][aheadIndex]" class="{{fc.weather_icon_name}}">
        <span ng-if="fc.query_time"> <!-- Easier than checking if object is empty -->
          <span ng-if="showTemps">{{fc.temp}}&deg;C</span>
        </span>
      </td>
    </tr>
  </table>
  
</div>
